<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Tracker - Create Tracking Links</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .tracking-link {
            transition: all 0.3s ease;
        }
        .tracking-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .map-container {
            height: 300px;
            background-color: #f0f0f0;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .data-card {
            transition: transform 0.3s ease;
        }
        .data-card:hover {
            transform: scale(1.02);
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="min-h-screen">
        <!-- Header -->
        <header class="gradient-bg text-white shadow-lg">
            <div class="container mx-auto px-4 py-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-6 md:mb-0">
                        <h1 class="text-3xl font-bold">Link<span class="text-yellow-300">Tracker</span></h1>
                        <p class="mt-2 text-blue-100">Create links that track visitor locations</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <img src="https://placehold.co/40x40" alt="User profile icon with gradient background" class="rounded-full h-10 w-10 object-cover">
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column - Link Generator -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-2xl font-semibold text-gray-800 mb-4">Create Tracking Link</h2>
                        <p class="text-gray-600 mb-6">Enter a destination URL and we'll generate a tracking link that captures visitor information.</p>
                        
                        <form id="linkForm" class="space-y-4">
                            <div>
                                <label for="destinationUrl" class="block text-sm font-medium text-gray-700 mb-1">Destination URL</label>
                                <input type="url" id="destinationUrl" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="https://example.com" required>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="linkName" class="block text-sm font-medium text-gray-700 mb-1">Link Name (optional)</label>
                                    <input type="text" id="linkName" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="My Tracking Link">
                                </div>
                                <div>
                                    <label for="campaign" class="block text-sm font-medium text-gray-700 mb-1">Campaign (optional)</label>
                                    <input type="text" id="campaign" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Marketing">
                                </div>
                            </div>
                            
                            <div class="pt-4">
                                <button type="submit" class="w-full gradient-bg text-white py-3 px-6 rounded-md font-medium hover:opacity-90 transition duration-300 flex items-center justify-center">
                                    <i class="fas fa-link mr-2"></i> Create Tracking Link
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Generated Link Section -->
                    <div id="generatedLinkSection" class="bg-white rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-2xl font-semibold text-gray-800 mb-4">Your Tracking Link</h2>
                        <div class="flex flex-col space-y-4">
                            <div class="flex items-center">
                                <input type="text" id="trackingLink" class="flex-grow px-4 py-3 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" readonly>
                                <button id="copyLink" class="bg-blue-600 text-white px-4 py-3 rounded-r-md hover:bg-blue-700 transition duration-300">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                            <div class="text-sm text-gray-500 flex items-center">
                                <i class="fas fa-info-circle mr-2 text-blue-500"></i>
                                This link will track visitors and collect location data when clicked.
                            </div>
                        </div>
                        
                        <div class="mt-6 border-t pt-6">
                            <h3 class="text-lg font-medium text-gray-800 mb-3">Link Analytics Preview</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                <div class="data-card bg-blue-50 p-4 rounded-lg text-center">
                                    <div class="text-blue-600 mb-1"><i class="fas fa-eye text-2xl"></i></div>
                                    <p class="text-gray-500 text-sm">Total Visits</p>
                                    <p class="text-xl font-bold text-gray-800" id="totalVisits">0</p>
                                </div>
                                <div class="data-card bg-green-50 p-4 rounded-lg text-center">
                                    <div class="text-green-600 mb-1"><i class="fas fa-map-marker-alt text-2xl"></i></div>
                                    <p class="text-gray-500 text-sm">Locations</p>
                                    <p class="text-xl font-bold text-gray-800" id="uniqueLocations">0</p>
                                </div>
                                <div class="data-card bg-purple-50 p-4 rounded-lg text-center">
                                    <div class="text-purple-600 mb-1"><i class="fas fa-mobile-alt text-2xl"></i></div>
                                    <p class="text-gray-500 text-sm">Devices</p>
                                    <p class="text-xl font-bold text-gray-800" id="deviceTypes">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right Column - Dashboard Preview -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-lg shadow-md p-6 sticky top-6">
                        <h2 class="text-2xl font-semibold text-gray-800 mb-4">Recent Activity</h2>
                        
                        <div class="map-container mb-6">
                            <img src="https://placehold.co/600x300" alt="World map visualization showing visitor locations from tracking links" class="w-full h-full object-cover rounded-lg">
                        </div>
                        
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <div class="bg-blue-100 p-2 rounded-full mr-3">
                                    <i class="fas fa-link text-blue-600"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-800">Link Created</p>
                                    <p class="text-sm text-gray-500">Create your first tracking link to see activity here</p>
                                    <p class="text-xs text-gray-400">Just now</p>
                                </div>
                            </div>
                            
                            <div class="py-2 border-t border-gray-100">
                                <h3 class="font-medium text-gray-800 mb-2">Quick Stats</h3>
                                <div class="flex items-center justify-between text-sm mb-1">
                                    <span class="text-gray-600">Total Links</span>
                                    <span class="font-medium" id="totalLinks">0</span>
                                </div>
                                <div class="flex items-center justify-between text-sm mb-1">
                                    <span class="text-gray-600">Active Links</span>
                                    <span class="font-medium" id="activeLinks">0</span>
                                </div>
                                <div class="flex items-center justify-between text-sm">
                                    <span class="text-gray-600">Total Visits</span>
                                    <span class="font-medium" id="dashboardTotalVisits">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Tracking Simulation Modal -->
    <div id="simulationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
            <div class="px-6 py-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800">Simulate Link Tracking</h3>
            </div>
            <div class="p-6">
                <p class="text-gray-600 mb-4">We'll simulate what happens when someone clicks your tracking link:</p>
                
                <div id="simulationSteps" class="space-y-4">
                    <div class="flex items-start">
                        <div class="bg-gray-100 rounded-full w-6 h-6 flex items-center justify-center mr-3 flex-shrink-0">1</div>
                        <div>
                            <p class="font-medium">Redirecting to destination URL...</p>
                            <p class="text-sm text-gray-500">User will be taken to your specified page</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="bg-gray-100 rounded-full w-6 h-6 flex items-center justify-center mr-3 flex-shrink-0">2</div>
                        <div>
                            <p class="font-medium">Collecting device information...</p>
                            <p class="text-sm text-gray-500">Browser, OS, device type</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="bg-gray-100 rounded-full w-6 h-6 flex items-center justify-center mr-3 flex-shrink-0">3</div>
                        <div>
                            <p class="font-medium">Requesting location data...</p>
                            <p class="text-sm text-gray-500">This requires user permission</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="bg-gray-100 rounded-full w-6 h-6 flex items-center justify-center mr-3 flex-shrink-0">4</div>
                        <div>
                            <p class="font-medium">Storing visit data...</p>
                            <p class="text-sm text-gray-500">Timestamp and analytics recorded</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-end space-x-3">
                <button id="cancelSimulation" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">Cancel</button>
                <button id="confirmSimulation" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Simulate Now</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables to store tracking data
        let trackingLinks = JSON.parse(localStorage.getItem('trackingLinks')) || [];
        let analyticsData = JSON.parse(localStorage.getItem('analyticsData')) || {};
        
        // DOM Elements
        const linkForm = document.getElementById('linkForm');
        const destinationUrl = document.getElementById('destinationUrl');
        const linkName = document.getElementById('linkName');
        const campaign = document.getElementById('campaign');
        const generatedLinkSection = document.getElementById('generatedLinkSection');
        const trackingLink = document.getElementById('trackingLink');
        const copyLink = document.getElementById('copyLink');
        const totalVisits = document.getElementById('totalVisits');
        const uniqueLocations = document.getElementById('uniqueLocations');
        const deviceTypes = document.getElementById('deviceTypes');
        const totalLinks = document.getElementById('totalLinks');
        const activeLinks = document.getElementById('activeLinks');
        const dashboardTotalVisits = document.getElementById('dashboardTotalVisits');
        const simulationModal = document.getElementById('simulationModal');
        const confirmSimulation = document.getElementById('confirmSimulation');
        const cancelSimulation = document.getElementById('cancelSimulation');
        
        // Update dashboard stats
        function updateDashboardStats() {
            totalLinks.textContent = trackingLinks.length;
            activeLinks.textContent = trackingLinks.filter(link => !link.archived).length;
            
            let total = 0;
            Object.values(analyticsData).forEach(linkData => {
                total += linkData.visits.length;
            });
            dashboardTotalVisits.textContent = total;
        }
        
        // Generate unique tracking ID
        function generateTrackingId() {
            return 'track_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Create tracking link
        function createTrackingLink(destUrl, name = '', campaignName = '') {
            const trackingId = generateTrackingId();
            const host = window.location.host;
            const protocol = window.location.protocol;
            
            // For demo purposes, we'll use a special route that simulates tracking
            // In a real app, this would point to your server endpoint
            const trackingUrl = `${protocol}//${host}/track/${trackingId}`;
            
            const newLink = {
                id: trackingId,
                destination: destUrl,
                name: name || `Link ${trackingLinks.length + 1}`,
                campaign: campaignName || 'General',
                created: new Date().toISOString(),
                archived: false
            };
            
            // Add to tracking links
            trackingLinks.push(newLink);
            localStorage.setItem('trackingLinks', JSON.stringify(trackingLinks));
            
            // Initialize analytics data for this link
            if (!analyticsData[trackingId]) {
                analyticsData[trackingId] = {
                    visits: [],
                    devices: {},
                    locations: {}
                };
                localStorage.setItem('analyticsData', JSON.stringify(analyticsData));
            }
            
            return {
                trackingUrl,
                trackingId,
                newLink
            };
        }
        
        // Simulate tracking
        function simulateTracking(trackingId) {
            // In a real app, this would be handled by your backend when the tracking link is visited
            const visitData = {
                timestamp: new Date().toISOString(),
                ip: '198.51.100.42', // Simulated IP
                userAgent: navigator.userAgent,
                device: getDeviceType(),
                location: null
            };
            
            // Simulate asking for location
            if (Math.random() > 0.5) { // 50% chance user grants location
                const randomLocations = [
                    { city: 'New York', country: 'USA', lat: 40.7128, lng: -74.0060 },
                    { city: 'London', country: 'UK', lat: 51.5074, lng: -0.1278 },
                    { city: 'Tokyo', country: 'Japan', lat: 35.6762, lng: 139.6503 },
                    { city: 'Sydney', country: 'Australia', lat: -33.8688, lng: 151.2093 },
                    { city: 'Berlin', country: 'Germany', lat: 52.5200, lng: 13.4050 }
                ];
                visitData.location = randomLocations[Math.floor(Math.random() * randomLocations.length)];
            }
            
            // Update analytics data
            const linkAnalytics = analyticsData[trackingId];
            linkAnalytics.visits.push(visitData);
            
            // Update device stats
            if (!linkAnalytics.devices[visitData.device]) {
                linkAnalytics.devices[visitData.device] = 0;
            }
            linkAnalytics.devices[visitData.device] += 1;
            
            // Update location stats
            if (visitData.location) {
                const locKey = `${visitData.location.city}, ${visitData.location.country}`;
                if (!linkAnalytics.locations[locKey]) {
                    linkAnalytics.locations[locKey] = 0;
                }
                linkAnalytics.locations[locKey] += 1;
            }
            
            localStorage.setItem('analyticsData', JSON.stringify(analyticsData));
            updateLinkStats(trackingId);
            updateDashboardStats();
            
            // In a real app, redirect to destination after tracking
            // window.location.href = destinationUrl;
            
            // For demo, just show a success message
            alert('Tracking simulation complete! The visit has been recorded to your analytics.');
        }
        
        // Get simplified device type
        function getDeviceType() {
            const ua = navigator.userAgent;
            if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)) {
                return 'Mobile';
            }
            if (/Tablet|iPad|Nexus 7|Nexus 10|Kindle Fire|Silk|KFAPWI|GT-P|SM-T/.test(ua)) {
                return 'Tablet';
            }
            return 'Desktop';
        }
        
        // Update link statistics display
        function updateLinkStats(trackingId) {
            const linkAnalytics = analyticsData[trackingId];
            if (linkAnalytics) {
                totalVisits.textContent = linkAnalytics.visits.length;
                uniqueLocations.textContent = Object.keys(linkAnalytics.locations).length;
                deviceTypes.textContent = Object.keys(linkAnalytics.devices).length;
            }
        }
        
        // Event Listeners
        linkForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!destinationUrl.value) {
                alert('Please enter a destination URL');
                return;
            }
            
            try {
                new URL(destinationUrl.value);
            } catch (e) {
                alert('Please enter a valid URL (including http:// or https://)');
                return;
            }
            
            // Create tracking link
            const { trackingUrl, trackingId } = createTrackingLink(
                destinationUrl.value,
                linkName.value,
                campaign.value
            );
            
            // Show the generated link section
            trackingLink.value = trackingUrl;
            generatedLinkSection.classList.remove('hidden');
            
            // Update stats
            updateLinkStats(trackingId);
            updateDashboardStats();
            
            // Reset form
            destinationUrl.value = '';
            linkName.value = '';
            campaign.value = '';
            
            // Show simulation modal
            simulationModal.classList.remove('hidden');
        });
        
        copyLink.addEventListener('click', function() {
            trackingLink.select();
            document.execCommand('copy');
            
            // Show copied feedback
            const originalText = copyLink.innerHTML;
            copyLink.innerHTML = '<i class="fas fa-check"></i> Copied!';
            setTimeout(() => {
                copyLink.innerHTML = originalText;
            }, 2000);
        });
        
        confirmSimulation.addEventListener('click', function() {
            simulationModal.classList.add('hidden');
            const trackingId = trackingLink.value.split('/').pop();
            simulateTracking(trackingId);
        });
        
        cancelSimulation.addEventListener('click', function() {
            simulationModal.classList.add('hidden');
        });
        
        // Initialize
        updateDashboardStats();
        
        // In a real application, you would:
        // 1. Have a backend API to handle the tracking links
        // 2. Store the tracking data securely in a database
        // 3. Implement proper user authentication
        // 4. Store more detailed analytics
        // 5. Provide a full dashboard with reports
        
        // For this demo, we're just simulating the functionality with localStorage
    </script>
</body>
</html>
